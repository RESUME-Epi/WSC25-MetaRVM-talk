---
title: "Developing and deploying a use-inspired metapopulation framework for stratified health outcomes"
subtitle: "Winter Simulation Conference, 2025"
author: "Presenter: Arindam Fadikar"
affiliation: "Decision and Infrastructure Sciences"
institute: "Argonne National Laboratory"
date: "December 8, 2025"
conference: "Winter Simulation Conference 2025"
format:
  revealjs:
    theme: simple
    slide-number: true
    incremental: false
    smaller: true
    toc: false
    code-fold: false
    code-overflow: scroll
    self-contained: true
    progress: true
    transition: fade
    navigation-mode: vertical
execute:
  echo: false
  warning: false
  message: false
  cache: false
---

## People involved

---

## Roadmap

- Motivation & collaboration context  
- MetaRVM modeling framework  
  - Metapopulation structure  
  - Disease progression model  
  - Mixing matrices from a synthetic population  
- Implementation as an **R package**
- Trajectory-oriented optimization 
- Case study: influenza in Chicago  


---

## Motivation

- Public health decision makers increasingly rely on **epidemiological models** to:
  - Forecast likely futures
  - Stress-test interventions
  - Plan resource allocation (e.g., beds, staffing)

---

## Motivation 

::: columns

::: {.column #ode-panel}
#### **Population-based ODE model**

- Aggregate-level dynamics  
- Homogeneous mixing assumptions 
- Computationally light and fast

![](figures/ode-model.png){width=60%}
:::

::: {.column #abm-panel}
#### **Agent-based model**

- Individual-level interactions  
- Heterogeneous contact network 
- Expensive to run for large population 

![](figures/abm-model.png){width=60%}
:::

:::

---

## Motivation {data-auto-animate="true" }

::: {.columns .three-panel}

::: {.column #ode-panel}
#### Population-based ODE model
- Aggregate-level dynamics  
- Homogeneous mixing assumptions

![](figures/ode-model.png){width=60%}
:::

::: {.column #metarvm-panel}
#### **MetaRVM**

- Stratified metapopulation structure  
- Time-varying mixing from synthetic contacts  

![](figures/meta-model.png){width=120%}
:::

::: {.column #abm-panel}
#### Agent-based model
- Individual-level interactions  
- Heterogeneous contact network 

![](figures/abm-model.png){width=60%}
:::

:::

---

## MetaRVM {.incremental}

- An open-source **R package** for modeling infectious disease spread across **stratified subpopulations**.
- Subpopulations can be defined by:
  - Geography (e.g., neighborhood, ZIP, zone)
  - Demographics (e.g., age, race/ethnicity)
- Features:
  - Time varying mixing pattern (weekday vs weekend, day vs night)
  - Extended SEIR-type disease progression
  - Checkpointing functionality
  - Integration with Trajectory-Oriented Optimization workflows

---

## MetaRVM - Disease model

![](figures/GIRD-Vensim.svg){width=100%}

---

## MetaRVM - Population mixing

![](figures/metafig.png){width=100%}

- Subpopulations based on age: children (green boxes), working-age adults (blue boxes), and seniors (orange boxes). 
- Different mixing patterns for daytime and nighttime.

---


## Mixing and force of infection

![](figures/metafig.png){width=100%}

- For each stratum, the **force of infection** depends on:
  - Mixing rates between strata $M = (m_{ij})$
  - Prevalence of infectious individuals in $j$th stratum $I_t^{(j)}$

---

## Mixing and force of infection

- **Effective interacting population (exclude H, D)**  

$$
\mathrm{MP}_t^{(j)} = P_t^{(j)} - H_t^{(j)} - D_t^{(j)}, \qquad j \in \mathcal{J}.
$$

- **Mixing across demographic strata**  

$M$: mixing matrix
$$
M = (m_{ij}), \qquad \sum_{j \in \mathcal{J}} m_{ij} = 1 \ \forall i,
$$

$$
\mathrm{MP}_{t,\text{eff}}^{(j)} = \sum_{i \in \mathcal{J}} m_{ij}\,\mathrm{MP}_t^{(i)}, \quad
S_{t,\text{eff}}^{(j)} = \sum_{i \in \mathcal{J}} m_{ij}\,S_t^{(i)}, \quad
I_{t,\text{eff}}^{(j)} = \sum_{i \in \mathcal{J}} m_{ij}\,I_t^{(i)}.
$$


---

## Mixing and force of infection

- **Force of infection (susceptible vs vaccinated)**  

$$
\lambda_{s,t}^{(j)} = \beta_s \frac{I_{t,\text{eff}}^{(j)}}{\mathrm{MP}_{t,\text{eff}}^{(j)}}, 
\qquad
\lambda_{v,t}^{(j)} = \beta_v \frac{I_{t,\text{eff}}^{(j)}}{\mathrm{MP}_{t,\text{eff}}^{(j)}}.
$$

- **S â†’ E transition in stratum \(j\)**  

$$
p_{\mathrm{SE}}^{(j)} = 1 - \exp\!\big(-\lambda_{s,t}^{(j)} \,\Delta t\big), 
\\
\Delta SE_t^{(j)} = p_{\mathrm{SE}}^{(j)}\,S_t^{(j)}.
$$

---


## Age-stratified model - illustration
### What we need

- Population counts
  - Source: Census
- Daily vaccination schedule
  - Source: CDPH
- Mixing matrices
  - Source: **ChiSIM** synthetic population

---

## Age-stratified model - illustration
### Synthetic population

- **Statistically representative synthetic population** of Chicago  
  (2.7M people, 1.4M places, 13k activity schedules)

- **Demographically accurate households** from ACS + PUMS at the CBG level

- **Workplaces** generated from County Business Patterns + LEHD OD data  
  (individuals assigned to realistic work locations)

- **Schools** assigned to all school-aged children  
  (some adults assigned schools as workplaces)

- **Additional mixing locations** (restaurants, gyms, etc.) from SafeGraph

---

## Age-stratified model - illustration
### Mobility --> Mixing


- **Agent mobility from real schedules**  
  - Adults: American Time Use Survey
  - Children: Panel Study of Income Dynamics
  - Each agent draws 1 of 10 possible schedules daily (weekday/weekend)

- **Endogenous contact network** emerges from hour-by-hour co-location of agents

- **Aggregate**
  - Count the total number of contacts that occur at each location between and within subpopulations
  - Normalize the counts to arrive at per-capita value

---

## Daytime vs Nightime mixing

::: columns

::: {.column #daytime}
#### **Daytime**

- Strong location based mixing

![](figures/day_contact.png){width=100%}
:::

::: {.column #nighttime}
#### **Nighttime**

- More household and community mixing

![](figures/night_contact.png){width=100%}
:::

:::

---


## Vaccination

![](figures/daily_vax.png){width=100%}

---


## TOO: overview

- Calibration goal:
  - Align model-generated hospitalizations with observed time series
- Approach:
  - Choose a set of calibration parameters (e.g., transmission scaling, reporting/observation fraction)
  - Define a loss function (e.g., squared error between modeled and observed hospitalizations)
  - Use **Bayesian optimization** to:
    - Explore parameter space efficiently
    - Balance exploitation and exploration
- Outcome:
  - Posterior-like distribution over plausible parameter values
  - Uncertainty envelopes around model trajectories

---

## Results

![](figures/chicago_fit_1-30_90p.png){width=100%}

## Summary

- MetaRVM provides a **use-inspired metapopulation modeling framework** for:
  - Detailed, stratified tracking of health outcomes
  - Infectious disease spread across multiple interacting subpopulations
- Key contributions:
  - Uses synthetic population-derived mixing matrices
  - Balances realism with computational efficiency
  - Delivered as an **open-source R package** with a **Shiny front end**
- Case study:
  - Demonstrated on influenza-related hospitalizations in Chicago
  - Supports prospective surveillance and scenario analysis

---


---


## Funding acknowledgments

- Chicago Department of Public Health  

---

## Questions?

*Thank you!*